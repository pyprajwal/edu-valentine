<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>For Edu ‚ù§Ô∏è</title>
<style>
/* Reset & body */
* {box-sizing:border-box;}
body {
  margin:0;
  font-family:'Segoe UI',sans-serif;
  text-align:center;
  overflow-x:hidden;
  background:linear-gradient(120deg,#ff758c,#ff7eb3);
  display:flex;
  flex-direction:column;
  align-items:center;
  -webkit-tap-highlight-color: transparent; /* removes tap highlight on mobile */
  touch-action: manipulation; /* disables double-tap zoom */
}

/* Heading */
h1 {
  color:white;
  text-shadow:0 0 10px #ff2f6d;
  cursor:pointer;
  font-size:6vw;
  margin:10px 0 5px 0;
}

/* Timer & Score */
#timer,#score {
  color:white;
  font-size:4vw;
  margin:4px 0;
}

/* Game container */
#game {
  width:90vw;
  max-width:400px;
  height:65vh;
  max-height:600px;
  background:rgba(255,255,255,.95);
  margin:15px auto;
  border-radius:20px;
  position:relative;
  overflow:hidden;
}

/* Player */
#player {
  width:20%;
  min-width:60px;
  max-width:90px;
  height:8%;
  min-height:30px;
  max-height:50px;
  background:linear-gradient(45deg,#ff416c,#ff4b2b);
  border-radius:30px;
  position:absolute;
  bottom:2%;
  left:40%;
  transition:left 0.05s linear; /* smooth for long press */
}

/* Tap Buttons */
#controls {
  display:flex;
  justify-content:center;
  gap:30px;
  margin-bottom:15px;
}
#controls button {
  font-size:7vw;
  padding:15px 25px;
  border-radius:25px;
  background:#ff4d6d;
  border:none;
  color:white;
  cursor:pointer;
  user-select:none;
  -webkit-user-select:none;
  touch-action: manipulation;
}

/* Falling hearts */
.heart {
  position:absolute;
  font-size:5vw;
}

/* Popup modal */
#popup {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:10;
}
#popup div {
  background:white;
  padding:5%;
  border-radius:20px;
  width:80%;
  max-width:350px;
  animation:pop .4s;
}
@keyframes pop {
  0%{transform:scale(.5);opacity:0}
  100%{transform:scale(1);opacity:1}
}

/* Images */
img {width:100%;border-radius:15px;}

/* Fireworks */
.firework {
  position:fixed;
  width:2vw;
  height:2vw;
  max-width:6px;
  max-height:6px;
  background:gold;
  border-radius:50%;
  animation:explode 1.2s linear infinite;
}
@keyframes explode {
  0%{transform:scale(1);opacity:1}
  100%{transform:scale(8);opacity:0}
}

/* Responsive iframes */
iframe {width:100%;height:200px;border-radius:15px;}
</style>
</head>
<body>

<h1>For My Edu ‚ù§Ô∏è</h1>
<div id="timer"></div>
<div id="score">Hearts: 0</div>
<div id="game"><div id="player"></div></div>

<!-- Tap Buttons for Mobile -->
<div id="controls">
  <button id="leftBtn">‚¨ÖÔ∏è</button>
  <button id="rightBtn">‚û°Ô∏è</button>
</div>

<div id="popup"><div id="popupContent"></div></div>

<audio id="bgAudio" loop>
  <source src="https://www.bensound.com/bensound-music/bensound-love.mp3" type="audio/mpeg">
</audio>

<script>
const audio = document.getElementById("bgAudio");

// Function to play audio once after first user interaction
function playAudioOnce() {
    // Unmute and play
    audio.muted = false;
    audio.play().catch(e => console.log("Audio play failed:", e));
    
    // Remove event listeners after first interaction
    document.removeEventListener("touchstart", playAudioOnce);
    document.removeEventListener("click", playAudioOnce);
}

// Listen for first tap/click anywhere on the page
document.addEventListener("touchstart", playAudioOnce, {once:true});
document.addEventListener("click", playAudioOnce, {once:true});

// Optional: mute initially so autoplay won't be blocked
audio.muted = true;
audio.play().catch(e => console.log("Initial muted autoplay failed:", e));

let score=0;
let leftPercent=40;
const player=document.getElementById("player");
const game=document.getElementById("game");
const popup=document.getElementById("popup");
const popupContent=document.getElementById("popupContent");
const scoreEl=document.getElementById("score");

const rewards={
5:"Edu, your smile makes my worst days better ü•∞",
20:typeLoveLetter,
25:showMap,
35:showSlideshow,
45:showBouquet,
60:secretUnlock,
80:finalProposal
};

// Long press movement
let moveInterval = null;
function startMove(direction){
  stopMove();
  moveInterval = setInterval(()=>{
    if(direction==="left"){ leftPercent -= 1; if(leftPercent<0) leftPercent=0; }
    else if(direction==="right"){ leftPercent +=1; if(leftPercent>80) leftPercent=80; }
    player.style.left = leftPercent + "%";
  },15);
}
function stopMove(){ if(moveInterval) clearInterval(moveInterval); }

document.getElementById("leftBtn").addEventListener("touchstart",()=>startMove("left"));
document.getElementById("leftBtn").addEventListener("touchend",stopMove);
document.getElementById("leftBtn").addEventListener("mousedown",()=>startMove("left"));
document.getElementById("leftBtn").addEventListener("mouseup",stopMove);

document.getElementById("rightBtn").addEventListener("touchstart",()=>startMove("right"));
document.getElementById("rightBtn").addEventListener("touchend",stopMove);
document.getElementById("rightBtn").addEventListener("mousedown",()=>startMove("right"));
document.getElementById("rightBtn").addEventListener("mouseup",stopMove);

// Falling hearts
function createHeart(){
  let h=document.createElement("div");
  h.className="heart"; h.innerHTML="‚ù§Ô∏è";
  h.style.left=Math.random()*90+"%";
  h.style.top="0%";
  game.appendChild(h);
  let fall=setInterval(()=>{
    h.style.top=(parseFloat(h.style.top)+1.5)+"%";
    let hr=h.getBoundingClientRect();
    let pr=player.getBoundingClientRect();
    if(hr.bottom>=pr.top && hr.left>=pr.left && hr.right<=pr.right){
      score++; scoreEl.innerHTML="Hearts: "+score;
      h.remove(); clearInterval(fall);
      if(rewards[score]) rewards[score]();
    }
    if(parseFloat(h.style.top)>100){h.remove(); clearInterval(fall);}
  },20);
}
let heartInterval = setInterval(createHeart, 750);

// Popup
function showPopup(html){
  popupContent.innerHTML = html + `<br><br><button onclick="closePopup()">Continue ‚ù§Ô∏è</button>`;
  popup.style.display = "flex";
}

function closePopup(){
  popup.style.display = "none";
}

// Love letter
function typeLoveLetter(){
  showPopup(`<h3>Edu, since 15 September 2025, my life changed forever. From Circular Quay to Bobbin Head and every moment after, you became my happiest place. I choose you ‚Äî today, tomorrow, always ‚ù§Ô∏è</h3>`);
}

// Map
function showMap(){
  showPopup(`<h3>Where We First Met üìç</h3>
  <iframe src="https://maps.google.com/maps?q=Sydney+Harbour+Circular+Quay&t=&z=14&output=embed"></iframe>`);
}

// Slideshow
function showSlideshow(){
  showPopup(`<h3> Memories üö§</h3>
  <img id="slide" src="img1 (1).JPEG">`);
  let imgs=[
   "img1 (2).JPEG", "img1 (3).JPEG","img1 (4).JPEG","img1 (5).JPEG","img1 (6).JPEG",
  "img1 (7).JPEG"
  ];  let i=0;
  let slideInterval = setInterval(()=>{
    let slide = document.getElementById("slide");
    if(!slide) { clearInterval(slideInterval); return; } // stop if popup closed
    i = (i+1) % imgs.length;
    slide.src = imgs[i];
  },1500);
}

// Bouquet
function showBouquet(){
  showPopup(`<h2>üåπ For My Edu üåπ</h2>
  <img src="https://images.unsplash.com/photo-1509042239860-f550ce710b93?auto=format&fit=crop&w=400&q=80">
  <p>These flowers will never fade ‚Äî just like my love for you ‚ù§Ô∏è</p>`);
}
// Secret
function secretUnlock(){
  showPopup(`<h3>üîê Secret Message</h3>
  <p>Password: <b> guess gara ;) </b></p>
  <input id="pass" placeholder="Enter password">
  <br><br><button onclick="unlock()">Unlock ‚ù§Ô∏è</button>`);
}

function unlock(){
  let p=document.getElementById("pass").value.toLowerCase();
  if(p==="emaya!") showPopup("<h3>No matter where life takes us, Edu, I choose you forever üíñ</h3>");
  else alert("Wrong üòú Try again!");
}
// Fireworks
function fireworks(){
  for(let i=0;i<40;i++){
    let f=document.createElement("div");
    f.className="firework";
    f.style.left=Math.random()*100+"vw";
    f.style.top=Math.random()*100+"vh";
    f.style.zIndex=9999;
    document.body.appendChild(f);
    setTimeout(()=>f.remove(),1200);
  }
}

// Final Proposal with YES button & 1 min firework
function finalProposal(){
  clearInterval(heartInterval);
  stopMove();
  document.getElementById("leftBtn").disabled=true;
  document.getElementById("rightBtn").disabled=true;
  document.getElementById("game").style.display="none";
  document.getElementById("controls").style.display="none";
  
  showPopup(`<h2>üíç Edu ‚ù§Ô∏è</h2>
  <p>From Circular Quay to Bobbin Head,<br>from our first laugh to forever...<br><br>
  Will you be my Valentine ‚Äî<br>today, tomorrow, and always? üíñ</p>
  <button onclick="yesCelebrate()">YES ‚ù§Ô∏è</button>`);
  
  let fireworkInterval = setInterval(fireworks,500);
  setTimeout(()=>{ clearInterval(fireworkInterval); location.reload(); },60000);
}

function yesCelebrate(){
  showPopup(`<h1>‚ù§Ô∏è YES! ‚ù§Ô∏è</h1>
  <p>Edu, I love you forever! üéâüéÜ</p>`);
  startFireworksForever();
}

function startFireworksForever(){
  setInterval(fireworks,500);
}

// Timer
function updateTimer(){
  const start=new Date("2025-09-15T00:00:00");
  const now=new Date();
  const diff=now-start;
  const days=Math.floor(diff/(1000*60*60*24));
  const hours=Math.floor((diff/(1000*60*60))%24);
  const mins=Math.floor((diff/(1000*60))%60);
  document.getElementById("timer").innerHTML=`Together: ${days} days ${hours} hrs ${mins} mins ‚ù§Ô∏è`;
}
setInterval(updateTimer,1000);
updateTimer();
</script>
</body>
</html>
